@IsTest
private with sharing class KafkaPerson2Test {
    @IsTest
    static void testParse() {
        String jsonString = '{"identer":[{"ident":"40000000000","historisk":true,"gruppe":"FOLKEREGISTERIDENT","metadata":null,"folkeregistermetadata":null},{"ident":"07000000000","historisk":false,"gruppe":"FOLKEREGISTERIDENT","metadata":null,"folkeregistermetadata":null},{"ident":"2400000000000","historisk":false,"gruppe":"AKTORID","metadata":null,"folkeregistermetadata":null}],"folkeregisteridentifikator":[{"identifikasjonsnummer":"40000000000","type":"DNR","status":"OPPHOERT","metadata":{"opplysningsId":"aa00aa0a-0000-0aaa-00aa-aa00aaa0aa00","master":"FREG","historisk":true,"endringer":[{"type":"OPPRETT","registrert":"2021-01-01T08:00:00.000","registrertAv":"Folkeregisteret","systemkilde":"FREG","kilde":"utlendingsdirektoratet"},{"type":"KORRIGER","registrert":"2021-01-01T08:00:00.000","registrertAv":"Folkeregisteret","systemkilde":"FREG","kilde":"utlendingsdirektoratet"}]},"folkeregistermetadata":{"ajourholdstidspunkt":"2021-01-01T08:00:00.000","gyldighetstidspunkt":"2021-01-01T08:00:00.000","opphoerstidspunkt":null,"kilde":"utlendingsdirektoratet","aarsak":"Innflytting"}},{"identifikasjonsnummer":"07000000000","type":"FNR","status":"I_BRUK","metadata":{"opplysningsId":"0a000000-0000-00a0-0aa0-0000aaa0a0a0","master":"FREG","historisk":false,"endringer":[{"type":"OPPRETT","registrert":"2021-01-01T08:00:00.000","registrertAv":"Folkeregisteret","systemkilde":"FREG","kilde":"utlendingsdirektoratet"}]},"folkeregistermetadata":{"ajourholdstidspunkt":"2021-01-01T08:00:00.000","gyldighetstidspunkt":"2021-01-01T08:00:00.000","opphoerstidspunkt":null,"kilde":"utlendingsdirektoratet","aarsak":"Innflytting"}}],"aktoerId":"2400000000000","folkeregisterId":["07000000000"],"navn":[{"fornavn":"TEST","mellomnavn":null,"etternavn":"TESTESEN"}],"forelderBarnRelasjoner":[{"relatertPersonsIdent":"40000000000","relatertPersonsRolle":"MOR","minRolleForPerson":"BARN"},{"relatertPersonsIdent":"06000000000","relatertPersonsRolle":"FAR","minRolleForPerson":"BARN"}],"folkeregisterpersonstatus":["bosatt"],"innflyttingTilNorge":[{"fraflyttingsland":"UGA","fraflyttingsstedIUtlandet":null}],"adressebeskyttelse":[],"sikkerhetstiltak":[],"bostedsadresse":{"vegadresse":[{"kommunenummer":"0301","adressenavn":"Slottsplassen","husnummer":"1","husbokstav":null,"postnummer":"0010","bydelsnummer":"04","koordinater":"1234.0,1234.0,0.0"}],"matrikkeladresse":[],"utenlandskAdresse":[],"ukjentBosted":[]},"oppholdsadresse":{"vegadresse":[],"matrikkeladresse":[],"utenlandskAdresse":[],"ukjentBosted":[]},"statsborgerskap":["NOR"],"sivilstand":[{"type":"UOPPGITT","gyldigFraOgMed":"2021-01-01","relatertVedSivilstand":null}],"kommunenummerFraGt":"0301","kommunenummerFraAdresse":"0301","bydelsnummerFraGt":"04","bydelsnummerFraAdresse":"04","kjoenn":["MANN"],"doedsfall":[],"telefonnummer":[],"utflyttingFraNorge":[],"talesspraaktolk":[],"fullmakt":[],"vergemaalEllerFremtidsfullmakt":[],"foedselsdato":["2000-01-01"]}';

        Test.startTest();
        System.assertNotEquals(null, KafkaPerson2.parse(jsonString), 'Expected to get a PDL person');
        Test.stopTest();
    }
}
